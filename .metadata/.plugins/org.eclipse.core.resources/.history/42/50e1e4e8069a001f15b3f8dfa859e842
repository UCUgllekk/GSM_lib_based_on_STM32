/*
 * GSM_MODULE.hpp
 *
 *  Created on: Nov 2, 2024
 *      Author: gllekk
 */

#ifndef INC_GSM_MODULE_HPP_
#define INC_GSM_MODULE_HPP_

#include <stm32f303xc.h>
#include <string>
#include "main.h"

class GSM_Module{
	struct Parameters{
		USART_HandleTypeDef *uart_handle;

		uint16_t rx_pin;
		GPIO_TypeDef *rx_port;

		uint16_t td_pin;
		GPIO_TypeDef *td_port;
	};
public:
		GSM_Module(const Parameters& parameters);
		int send_sms(const std::string& message);
		void make_call();
		bool send_AT();
private:
		int send_at_command(const std::string& command);
		Parameters parameters;
};

GSM_Module::Parameters load_parameters(){
	GSM_Module::Parameters parameters;
	parameters.uart_handle = &huart1;
	parameters.rx_pin = RX_FROM_GSM_Pin;
	parameters.rx_port = RX_FROM_GSM_GPIO_Port;
	parameters.td_pin = TRANS_TO_GSM_Pin;
	parameters.td_port = TRANS_TO_GSM_GPIO_Port;
	return parameters;
}
#endif /* INC_GSM_MODULE_HPP_ */
